<!DOCTYPE html>
<html lang="pt br"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="img/icon.ico">

    <title>Cadastre-se</title>
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

</head>


<body>
<section class="vh-100" style="background-color: #9A616D;">
  <div class="container py-5 h-100">
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="col col-xl-10">
        <div class="card" style="border-radius: 1rem;">
          <div class="row g-0">
            <div class="col-md-6 col-lg-5 d-none d-md-block">
              <img src="img/img1.png"
                alt="login form" class="img-fluid" style="border-radius: 1rem 0 0 1rem;" />
            </div>
            <div class="col-md-6 col-lg-7 d-flex align-items-center">
              <div class="card-body p-4 p-lg-5 text-black">

                <form>

                  <div class="d-flex align-items-center mb-3 pb-1">
                    <i class="fas fa-cubes fa-2x me-3" style="color: #ff6219;"></i>
                    <span class="h2 fw-bold mb-0">Cadastre-se no chat max</span>
                  </div>

    

                  <div data-mdb-input-init class="form-outline mb-4">
                     <label class="form-label" for="form2Example17">Login</label>
                    <input type="text" id="username" class="form-control form-control-lg" />
                   
                  </div>

                  <div data-mdb-input-init class="form-outline mb-4">
                   <label class="form-label" for="form2Example27">Password</label>
                    <input type="password" id="password" class="form-control form-control-lg" />
                    
                  </div>

                  <div class="pt-1 mb-4 form-outline mb-4">
                    <button data-mdb-button-init data-mdb-ripple-init class="btn btn-primary btn-lg btn-block form-control form-control-lg" type="button" id="cadastrar">Cadastrar</button>
                  </div>
                  
<a href="chatmax.html"
style="color: #393f81;">Tem uma conta ? Click aqui</a></p>
                 
                </form>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

</body>

</html>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script>
 
document.getElementById('cadastrar').addEventListener('click',function(){  

var login=document.getElementById("username").value;
var password=document.getElementById("password").value;
                     
$.post( "http://142.93.146.197:4041/addusers",{
   login:login,
   password:password,
   admin:false,
   type:"jsonop",
   headers: {
     'Content-Type': 'application/json'
  }

},function( data ){
 
let timerInterval;
Swal.fire({
  title: "Obrigado",
  html: "Voce sera redirecionado em alguns segundos <b></b> .",
  imageUrl: "img/123456789.png",
  timer: 3000,
  timerProgressBar: true,
  didOpen: () => {
    Swal.showLoading();
    const timer = Swal.getPopup().querySelector("b");
    timerInterval = setInterval(() => {
      timer.textContent = `${Swal.getTimerLeft()}`;
    }, 100);
  },
  willClose: () => {
    clearInterval(timerInterval);

  }
}).then((result) => {
  /* Read more about handling dismissals below */
  if (result.dismiss === Swal.DismissReason.timer) {
    location.href="http://142.93.146.197/chatmax"
  }
})

}).fail(function(data) {
  if(data.responseJSON.hasOwnProperty('menssagem')){
        Swal.fire("Erro:",data.responseJSON.menssagem, "error");
    return 
  }
       if(data.responseJSON.hasOwnProperty('errors')==false){
        Swal.fire("Erro", "Erro inesperado", "error");
        return false;
    }
    var mssage="";
    var contador=0;
      data.responseJSON.errors.forEach(function(ms,indx){
            contador++;
            mssage+=""+ms.msg+"<br> "

            if(contador==data.responseJSON.errors.length){
                
                 Swal.fire({
                          position: "top-end",
                          icon: "error",
                          title: "Falhou",
                          html:mssage,
                          showConfirmButton: false,
                          timer: 3000
                        });
         
            }
      })

    
     });
   
   })

</script>


